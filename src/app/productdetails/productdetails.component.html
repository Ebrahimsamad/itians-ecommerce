<div class="container my-5">
    <a routerLink="/products" routerLinkActive="active" class="text-warning mb-3 d-block">
        ← Back to product list
    </a>
    <div class="row">
        <!-- Image Slider Section -->
        <div class="col-md-6 col-12">
            <div class="product-image">
                <img [src]="selectedImage" class="img-fluid" alt="Product Image">
                <div class="d-flex justify-content-between mt-3">
                    <button class="btn btn-outline-warning" (click)="prevImage()"><i
                            class="fa-solid fa-arrow-left"></i></button>
                    <button class="btn btn-outline-warning" (click)="nextImage()"><i
                            class="fa-solid fa-arrow-right"></i></button>
                </div>
                <div class="d-flex mt-3">
                    <img *ngFor="let img of product?.images; let i = index" [src]="img"
                        [class.active]="img === selectedImage" class="img-thumbnail mx-1" (click)="selectImage(i)"
                        alt="Product Thumbnail">
                </div>
            </div>
        </div>
        <!-- Product Details Section -->
        <div class="col-md-6 col-12">
            <div *ngIf="product; else loading">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <span class="badge bg-light text-dark p-2">
                        Save {{ savedAmount | currency:'USD' }} ({{ product.discountPercentage }}%)
                    </span> <span class="text-muted">{{ product.availabilityStatus }}</span>
                </div>
                <h2 class="mb-4">{{ product.title }}</h2>
                <h4 class="text-">
                    ${{ getDiscountedPrice() | number: '1.2-2' }}
                    <small class="text-muted text-decoration-line-through" *ngIf="product.discountPercentage > 0">
                        ${{ product.price | number: '1.2-2' }}
                    </small>
                </h4>

                <p>Price: ${{ product.price }}</p>
                <p class="text-muted mb-2">Product code: {{ product.sku }}</p>
                <p class="text-success mb-2">In Stock: {{ product.stock }}</p>
                <p class="mb-4">{{ product.description }}</p>
                <div class="d-flex align-items-center mb-3">
                    <!-- عرض النجوم -->
                    <ng-container *ngIf="product.rating != null">
                        <ng-container *ngFor="let _ of getStars(product.rating).fullArray">
                            <i class="fa-solid fa-star"></i>
                        </ng-container>
                        <ng-container *ngIf="getStars(product.rating).half">
                            <i class="fa-solid fa-star-half-alt"></i>
                        </ng-container>
                    </ng-container>
                    <!-- عرض التقييم وعدد المراجعات -->
                    <span class="ms-2">{{ product.rating }} ({{ product.reviews.length }} Reviews)</span>
                </div>

                <div class="d-flex align-items-center mb-4">
                    <button class="btn btn-outline-secondary me-2" (click)="decreaseQuantity()">-</button>
                    <input type="number" [(ngModel)]="quantity" class="form-control w-auto text-center" min="1"
                        [max]="product.stock" readonly>
                    <button class="btn btn-outline-secondary ms-2" (click)="increaseQuantity()">+</button>
                </div>
                <div class="d-flex mb-lg-4">
                    <button class="btn g-1 text-white" [ngStyle]="{'background-color': '#e6a23c'}">Buy Now</button>

                    <button class="btn btn-outline-secondary"
                        [ngStyle]="{'border-color': '#34504d', 'color': '#34504d'}" (click)="addToCart()">Add To
                        Cart</button>

                    <div class="favorite-btn" (click)="toggleFavorite(product)">
                        <i [ngClass]="getIconClass()" [ngStyle]="{'color': isFavorite() ? 'red' : '#34504d'}"></i>
                    </div>
                </div>


            </div>
            <ng-template #loading>
                <p>Loading product details...</p>
            </ng-template>
        </div>
    </div>

    <!-- Tabs Section -->
    <!-- Tabs Section -->
    <ul class="nav nav-tabs mt-5" id="productTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="details-tab" data-bs-toggle="tab" data-bs-target="#details"
                type="button" role="tab" aria-controls="details" aria-selected="true">Product Details</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button"
                role="tab" aria-controls="reviews" aria-selected="false">Customer Reviews</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="description-tab" data-bs-toggle="tab" data-bs-target="#description"
                type="button" role="tab" aria-controls="description" aria-selected="false">Description</button>
        </li>
    </ul>

    <!-- Additional Product Details -->
    <div class="tab-content" id="productTabsContent">
        <div class="tab-pane fade show active" id="details" role="tabpanel" aria-labelledby="details-tab">
            <!-- Product Details Section -->
            <div class="product-details mt-4">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th colspan="4" class="text-center">Product Information</th>
                        </tr>
                        <tr>
                            <th>Features</th>
                            <th>Details</th>

                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Brand</td>
                            <td>{{ product.brand }}</td>
                        </tr>
                        <tr>
                            <td>Dimensions</td>
                            <td>{{ product.dimensions.width }} x {{ product.dimensions.height }} x {{
                                product.dimensions.depth }} cm</td>
                        </tr>
                        <tr>
                            <td>Weight</td>
                            <td>{{ product.weight }} kg</td>
                        </tr>
                        <tr>
                            <td>Warranty Information</td>
                            <td>{{ product.warrantyInformation }}</td>
                        </tr>
                        <tr>
                            <td>Shipping Information</td>
                            <td>{{ product.shippingInformation }}</td>
                        </tr>
                        <tr>
                            <td>Tags</td>
                            <td>
                                <span *ngFor="let tag of product.tags" class="badge bg-secondary me-1">{{ tag }}</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>


    <!-- Reviews Section -->
    <div class="tab-pane fade" id="reviews" role="tabpanel" aria-labelledby="reviews-tab">
        <!-- Reviews Section -->
        <div class="reviews mt-4">
            <div *ngFor="let review of product.reviews" class="mb-4">
                <div class="d-flex justify-content-between">
                    <div>
                        <strong>{{ review.reviewerName }}</strong>
                    </div>
                    <small class="text-muted">{{ review.date }}</small>
                </div>
                <div class="d-flex align-items-center mt-2">
                    <!-- عرض النجوم للمراجعة -->
                    <ng-container *ngIf="review.rating != null">
                        <ng-container *ngFor="let _ of getStars(review.rating).fullArray">
                            <i class="fa-solid fa-star"></i>
                        </ng-container>
                        <ng-container *ngIf="getStars(review.rating).half">
                            <i class="fa-solid fa-star-half-alt"></i>
                        </ng-container>
                    </ng-container>
                </div>
                <p class="mt-2">{{ review.comment }}</p>
            </div>
        </div>
    </div>



    <!-- Coupon Section -->
    <div class="tab-pane fade" id="description" role="tabpanel" aria-labelledby="description-tab">
        <!-- Description Section -->
        <div class="description mt-4">
            <!-- أضف هنا وصف المنتج الذي تريد عرضه -->
            <p>{{ product.description }}</p>
        </div>
    </div>